parameters:
  lcm_monitoring.log_socket: "tcp://host.docker.internal:9001"

services:
  monolog.handler.lcm:
    class: Monolog\Handler\WhatFailureGroupHandler
    arguments: [["@monolog.handler.lcm_inner"]]
  monolog.handler.lcm_inner:
    class: Monolog\Handler\SocketHandler
    arguments: ["%lcm_monitoring.log_socket%"]
    calls:
      - method: setFormatter
        arguments: ['@monolog.formatter.lcm']
      - method: setConnectionTimeout
        arguments: [3]
      - method: setPersistent
        arguments: [true]

  monolog.formatter.lcm:
    class: Drupal\lcm_monitoring\ECSFormatter
